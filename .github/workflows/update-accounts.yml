name: ğŸ†” Manual Update Account IDs

on:
  workflow_dispatch:      # ğŸ”¥ å…³é”®ï¼šè¿™å°±å…è®¸ä½ åœ¨ç½‘é¡µä¸Šç‚¹å‡»æŒ‰é’®è§¦å‘

jobs:
  update-ids:
    runs-on: ubuntu-latest
    permissions:
      contents: write     # å…è®¸æäº¤ä»£ç 
      
    steps:
      - uses: actions/checkout@v3
        with:
          token: ${{ secrets.GH_TOKEN }}
          
      - name: Setup Bun
        uses: oven-sh/setup-bun@v1
        with:
          bun-version: latest
          
      - name: Install dependencies
        run: bun install
        
      # è¿è¡Œä½ çš„ index.ts è„šæœ¬
      - name: Update Account IDs
        env:
          GET_ID_X_TOKEN: ${{ secrets.GET_ID_X_TOKEN }} # ç¡®ä¿ä½ åœ¨ Secrets é‡Œé…äº†è¿™ä¸ª
        run: bun run scripts/index.ts
        
      - name: Commit changes
        run: |
          git config --global user.name 'ID Updater Bot'
          git config --global user.email 'bot@updater.alpha'
          # å¦‚æœæœ‰å˜åŠ¨æ‰æäº¤
          git add accounts/
          git commit -m "chore: manual update account ids [skip ci]" || echo "No changes to commit"
          git push
